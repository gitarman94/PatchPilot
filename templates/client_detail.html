<div class="row g-3">
    <div class="col-12">
        <h4>General Info</h4>
        <ul class="list-group">
            <li class="list-group-item"><strong>ID:</strong> {{ client.id }}</li>
            <li class="list-group-item"><strong>Hostname:</strong> {{ client.client_name or 'â€”' }}</li>
            <li class="list-group-item"><strong>OS:</strong> {{ client.os_name or 'â€”' }} {{ client.os_version or '' }}</li>
            <li class="liststrong>CPU:</strong> {{ client.cpu or 'â€”' }}</li>
            <li class="list-group-item"><strong>RAM:</strong> {{ client.ram or 'â€”' }}</li>
            <li class="list-group-item"><strong>Disk:</strong> {{ client.disk_total or 'â€”' }}/{{ client.disk_free or 'â€”' }}</li>
            <li class="list-group-item"><strong>Uptime:</strong> {{ client.uptime or 'â€”' }}</li>
            <li class="list-group-item"><strong>Last checkâ€‘in:</strong> {{ client.last_checkin or 'Never' }}</li>
            <li class="list-group-item"><strong>Status:</strong>
                {% if client.last_checkin and (now - client.last_checkin).total_seconds() < 600 %}
                    <span class="status-online">ğŸŸ¢ Online</span>
                {% else %}
                    <span class="status-offline">ğŸ”´ Offline</span>
                {% endif %}
            </li>
            <li class="list-group-item"><strong>Patch status:</strong>
                {% if client.updates_available %}
                    <span class="badge bg-warning text-dark">âš ï¸ Updates pending</span>
                {% else %}
                    <span class="badge bg-success">âœ… Upâ€‘toâ€‘date</span>
                {% endif %}
            </li>
        </ul>
    </div>

    <div class="col-12 mt-4">
        <h4>Available Updates ({{ updates|length }})</h4>
        {% if updates %}
        <form method="post" action="/api/clients/{{ client.id }}/commands" class="mb-3">
            <input type="hidden" name="admin_token" value="{{ ADMIN_TOKEN or '' }}">
            <input type="hidden" name="action" value="install_selected_updates">
            {% for upd in updates %}
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="updates"
                       value="{{ upd.kb_or_package }}" id="upd{{ loop.index }}">
                <label class="form-check-label" for="upd{{ loop.index }}">
                    <strong>{{ upd.title or upd.kb_or_package }}</strong>
                    {% if upd.severity %} - {{ upd.severity }}{% endif %}
                </label>
            </div>
            {% endfor %}
            <button type="submit" class="btn btn-primary mt-2">Install selected</button>
        </form>

        <form method="post" action="/api/clients/{{ client.id }}/commands">
            <input type="hidden" name="admin_token" value="{{ ADMIN_TOKEN or '' }}">
            <input type="hidden" name="action" value="install_all_updates">
            <button type="submit" class="btn btn-success">Install all updates</button>
        </form>
        {% else %}
        <p class="text-muted">No updates available.</p>
        {% endif %}
    </div>

    <div class="col-12 mt-4">
        {% if client.approved is not defined or not client.approved %}
        <form method="post" action="/approve/{{ client.id }}" class="d-inline">
            <button type="submit" class="btn btn-warning">Approve client</button>
        </form>
        {% endif %}
        <form method="post" action="/admin/force-update/{{ client.id }}" class="d-inline">
            <button type="submit" class="btn btn-danger">Force update</button>
        </form>
        <form method="post" action="/admin/allow-checkin/{{ client.id }}" class="d-inline">
            <button type="submit" class="btn btn-info">Allow checkâ€‘in</button>
        </form>
    </div>
</div>

