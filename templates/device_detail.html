<div class="container py-3">
    <h3 id="deviceName"></h3>
    <div class="row mt-3">
        <div class="col-md-6">
            <p><strong>Device ID:</strong> <span id="deviceId"></span></p>
            <p><strong>Hostname:</strong> <span id="deviceHostname"></span></p>
            <p><strong>OS Name:</strong> <span id="deviceOS"></span></p>
            <p><strong>OS Version:</strong> <span id="deviceOSVersion"></span></p>
            <p><strong>CPU Usage:</strong> <span id="deviceCPU"></span></p>
            <p><strong>RAM:</strong> <span id="deviceRAM"></span></p>
            <p><strong>Disk:</strong> <span id="deviceDisk"></span></p>
            <p><strong>Disk Health:</strong> <span id="deviceDiskHealth"></span></p>
            <p><strong>Patch Status:</strong> <span id="devicePatchStatus"></span></p>
            <p><strong>Last Patch Date:</strong> <span id="deviceLastPatch"></span></p>
        </div>
        <div class="col-md-6">
            <p><strong>Network Throughput:</strong> <span id="deviceNetwork"></span></p>
            <p><strong>Ping Latency:</strong> <span id="devicePing"></span></p>
            <p><strong>Uptime:</strong> <span id="deviceUptime"></span></p>
            <p><strong>Last Check-in:</strong> <span id="deviceCheckin"></span></p>
            <p><strong>Updates Available:</strong> <span id="deviceUpdates"></span></p>
            <p><strong>Approved:</strong> <span id="deviceApproved"></span></p>
            <p><strong>Serial Number:</strong> <span id="deviceSerial"></span></p>
            <p><strong>Model:</strong> <span id="deviceModel"></span></p>
            <p><strong>Manufacturer:</strong> <span id="deviceManufacturer"></span></p>
            <p><strong>Additional Notes:</strong> <span id="deviceNotes"></span></p>
        </div>
    </div>
</div>

<script>
async function loadDeviceDetails(deviceId) {
    const body = $('#deviceDetailBody');
    body.html('<div class="text-center py-5"><div class="spinner-border" role="status"></div></div>');

    try {
        const res = await fetch(`/api/devices/${deviceId}`);
        const d = await res.json();

        $('#deviceName').text(d.device_name || '—');
        $('#deviceId').text(d.id || '—');
        $('#deviceHostname').text(d.hostname || '—');
        $('#deviceOS').text(d.os_name || '—');
        $('#deviceOSVersion').text(d.os_version || '—');
        $('#deviceCPU').text(d.cpu != null ? d.cpu.toFixed(1) + '%' : '—');
        $('#deviceRAM').text(d.ram_total ? `${d.ram_used} / ${d.ram_total} MB` : '—');
        $('#deviceDisk').text(d.disk_total ? `${d.disk_total - d.disk_free} / ${d.disk_total} GB` : '—');
        $('#deviceDiskHealth').text(d.disk_health || '—');
        $('#devicePatchStatus').text(d.patch_status || '—');
        $('#deviceLastPatch').text(d.last_patch_date || '—');

        $('#deviceNetwork').text(d.network_throughput || '—');
        $('#devicePing').text(d.ping_latency != null ? d.ping_latency + ' ms' : '—');
        $('#deviceUptime').text(d.uptime ? `${d.uptime} sec` : '—');
        $('#deviceCheckin').text(d.last_checkin || '—');
        $('#deviceUpdates').text(d.updates_available ? 'Yes' : 'No');
        $('#deviceApproved').text(d.approved ? 'Yes' : 'No');
        $('#deviceSerial').text(d.serial_number || '—');
        $('#deviceModel').text(d.model || '—');
        $('#deviceManufacturer').text(d.manufacturer || '—');
        $('#deviceNotes').text(d.notes || '—');
    } catch (err) {
        body.html('<p class="text-danger">Failed to load device details.</p>');
        console.error(err);
    }
}
</script>
